<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chuck Mason</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2fa0555fe88427c29efa1b60aaf9e62d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-24313ffe018a360e4389e67f63785bb1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
  body.page-index .navbar {
    display: none !important;
  }
</style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Chuck Mason</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./travels.html"> 
<span class="menu-text">Travels</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./kiwi_adventures.html"> 
<span class="menu-text">Kiwi Adventures</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block"></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">
<div id="hero-navbar">
  <nav class="navbar navbar-expand-lg" style="background-color:#4ca2ff;">
    <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#heroNavbarCollapse" aria-controls="heroNavbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="heroNavbarCollapse">
        <ul class="navbar-nav navbar-nav-scroll ms-auto">
          <li class="nav-item">
            <a class="nav-link active" href="./index.html" aria-current="page"> 
          <span class="menu-text">Home</span></a>
          </li>  
          <li class="nav-item">
            <a class="nav-link" href="./travels.html"> 
          <span class="menu-text">Travels</span></a>
          </li>  
          <li class="nav-item">
            <a class="nav-link" href="./kiwi_advantures.html"> 
        <span class="menu-text">Kiwi Advantures</span></a>
          </li>  
        </ul>
      </div>
    </div>
  </nav>

  <div class="nav-title">
    CHUCK MASON'S HOME PAGE
  </div>
</div>




<div class="page-index">
<div class="columns">
<div class="column" style="width:45%;">
<p><img src="uploads/1/2/4/5/124536544/published/cfmason.jpg" class="img-fluid"></p>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:50%;">
<section id="a-little-bit-about-me" class="level2">
<h2 class="anchored" data-anchor-id="a-little-bit-about-me">A little bit about me:</h2>
<p>I have a long-standing interest in Resource Economics. Some of the topics I have conducted research on include issues regarding exploration for and extraction of non-renewable resources, and issues regarding common-property resources, particularly those that are renewable. I have also conducted a number of analyses that apply experimental economics techniques to theoretical issues in Industrial Organization.</p>
<p><a href="travels.html" class="cta-button">LEARN MORE</a></p>
</section>
</div>
</div>
<section id="here-is-a-list-of-recent-working-papers" class="level2">
<h2 class="anchored" data-anchor-id="here-is-a-list-of-recent-working-papers">Here is a list of recent working papers:</h2>
<ul>
<li><p><strong>Whose Frac is It, Anyway? Using Sources of Productivity Gains to Explain Industrial Organization in Oilfield Services</strong> <a href="uploads/1/2/4/5/124536544/whosefrack.pdf">pdf file</a><br>
We analyze the the relative roles played by sellers and buyers of frac jobs on experimentation, innovation, and diffusion of knowledge about hydraulic fracturing. An historically-concentrated sector has experienced substantial entry and erosion due to vertical integration by buyers. This changing industrial organization affects and is affected by the changing relative technical proficiency of service companies and their operator clients. We document how a proxy for the technical prowess of the oilfield service sector has changed substantially over time, consistent with weakening. It is not clear from the evidence brought to bear what the direction of causation is.</p></li>
<li><p><strong>Why do Firms Hold Oil Stockpiles?</strong> <a href="uploads/1/2/4/5/124536544/oil_inventories.pdf">pdf file</a><br>
Persistent and significant privately-held stockpiles of crude oil have long been an important empirical regularity in the United States. Such stockpiles would not rationally be held in a traditional Hotelling-style model. How then can the existence of these inventories be explained? In the presence of sufficiently stochastic prices, oil extracting firms have an incentive to hold inventories to smooth production over time. An alternative explanation is related to a speculative motive - firms hold stockpiles intending to cash in on periods of particularly high prices. I argue that empirical evidence supports the former but not the latter explanation.</p></li>
<li><p><strong>Jumping Beans: Implications of Fat Tails in International Soybean Markets</strong> <a href="uploads/1/2/4/5/124536544/Soybean-jump_v2.pdf">pdf file</a><br>
Economies are increasingly adopting renewable energy certificates as a policy mechanism to support the transition away from reliance on fossil fuels. We investigate the price of solar renewable energy certificates (SRECs) in New Jersey, allowing for the potential presence of jumps and time-varying volatility. We find that both features play an important role in the stochastic process describing SREC price returns. We also simulate the implied probability that at least one jump would occur in any given month. These implied probabilities indicate that jumps played a consistently important role in both SRECs and electricity prices. Jumps in SRECs appear to have been particularly noteworthy between late 2011 and early 2013, a period when electricity prices in New Jersey were relatively high. This result hints at the potentially important role of market structure in driving fat tails in price returns.</p></li>
<li><p><strong>On the Interaction of Eco-Labeling and Trade</strong> <a href="uploads/1/2/4/5/124536544/Labeling_Trade.pdf">pdf file</a><br>
While environmental certification can provide useful information to consumers, there is concern that it indirectly erects trade barriers. I construct a two-country model where some firms use an environmentally-unfriendly (brown) production technology in each country, while other firms use environmentally-friendly (green) techniques. There are two green techniques, one in each country. Obtaining the eco-label entails certification costs; green firms in the exporting country must bear an additional cost to obtain the eco-label. I discuss the impact of eco-labeling on the quantities of green goods produced in each country and resultant welfare impacts, and the impact of changes in labeling costs.</p></li>
<li><p><strong>Volatility in Solar Renewable Energy Certificates: Jumps and Fat Tails</strong> <a href="uploads/1/2/4/5/124536544/SolarJumpSREC_Oct2024.pdf">pdf file</a><br>
Economies are increasingly adopting renewable energy certificates as a policy mechanism to support the transition away from reliance on fossil fuels. We investigate the price of solar renewable energy certificates (SRECs) in New Jersey, allowing for the potential presence of jumps and time-varying volatility. We find that both features play an important role in the stochastic process describing SREC price returns. We also simulate the implied probability that at least one jump would occur in any given month. These implied probabilities indicate that jumps played a consistently important role in both SRECs and electricity prices. Jumps in SRECs appear to have been particularly noteworthy between late 2011 and early 2013, a period when electricity prices in New Jersey were relatively high. This result hints at the potentially important role of market structure in driving fat tails in price returns.</p></li>
<li><p><strong>The Transition to Renewable Energy</strong> <a href="uploads/1/2/4/5/124536544/JAERE_v5.pdf">pdf file</a><br>
The existing economics literature neglects the important role of capacity in the production of renewable energy. To fill this gap, we construct a model in which renewable energy production is tied to renewable energy capacity, which then becomes a form of capital. This capacity capital can be increased through investment, which therefore comes at the cost of reduced consumption. We describe how society could optimally elect to split production between immediate consumption and investment in the two forms of capital. Our model delivers an empirically satisfactory explanation for simultaneous use of non-renewable and renewable energy. While transitioning to renewable energy can often ensure perennially increasing utility, there are combinations of initial levels of the non-renewable resource and renewable capacity that can generate Malthusian-like effects, with utility declining at some point in time.</p></li>
<li><p><strong>Analyzing the Risk of Transporting Crude Oil by Rail</strong> <a href="uploads/1/2/4/5/124536544/Oil_by_Rail.pdf">pdf file</a><br>
In this paper, I combine data on incidents associated with rail transportation of crude oil and detailed data on rail shipments to appraise the relation between increased use of rail to transport crude oil and the risk of safety incidents associated with those shipments. I find a positive link between the accumulation of minor incidents and the frequency of serious incidents, and a positive relation between increased rail shipments of crude oil and the occurrence of minor incidents. I also find that increased shipments are associated with a rightward shift in the distribution of economic damages associated with these shipments; the implied marginal impact of an additional 1,000 rail cars carrying oil between two states in a given month is $1,925. In addition, I find larger average effects associated with states that represent the greatest source of tight oil production.</p></li>
<li><p><strong>Optimal Contracts for Discouraging Deforestation with Risk Averse Agents</strong> <a href="uploads/1/2/4/5/124536544/ContractingCarbonOffsets-RAv05.pdf">pdf file</a><br>
As we enter the second decade of the 21st century there is an emerging consensus that carbon emissions must be limited. An attractive approach to promoting carbon reductions, which offers a variety of co-benefits, is to encourage reductions in deforestation. Despite this potential, any strategy geared towards encouraging such reductions must confront a basic problem, stemming from symmetric information: agents that might be induced to reduce their actions which would reduce forests have private information about their opportunity costs. This concern seems particularly likely to apply in situations where there are significant related risks, as agents seem highly likely to differ in their tolerance for risk. In this paper, I investigate a contracting scheme designed to mitigate the asymmetric information problem where agents are heterogeneous in their tolerance for risk.</p></li>
</ul>
</section>
<section id="professional-activities" class="level2">
<h2 class="anchored" data-anchor-id="professional-activities">Professional Activities</h2>
<p>I was the Managing Editor of the <a href="https://www.sciencedirect.com/journal/journal-of-environmental-economics-and-management">Journal of Environmental Economics and Management</a> from 2006 to 2011, and a Co-Editor for the <a href="https://www.journals.uchicago.edu/toc/jaere/current">Journal of the Association of Environmental and Resource Economists</a> from 2014 to 2016. I am currently Editor-in-Chief for <a href="https://www.iaee.org/en/publications/eeepscope.aspx">Economics of Energy and Environmental Policy</a> and Joint Editor-in-Chief for <a href="https://www.nowpublishers.com/SBE">Strategic Behavior and the Environment</a>. I am also a University Fellow with <a href="http://www.rff.org/">Resources for the Future</a>. In September 2023 I had the great pleasure to be named a <a href="https://faere.fr/en/members/honorary-members/">member of honor</a> in the French Association of Environmental and Resource Economists.</p>
<p>From May 2014 to January 2015 I was involved in the U.S. Department of Justice’s case related to the Deepwater Horizon oil spill, which culminated in my <a href="https://www.nola.com/news/business/bp-oil-spill-rippled-through-fabric-of-gulf-coast-economy-witness-testifies/article_c29487ec-ac76-579e-896e-8d0a5895206f.html">testimony</a>.</p>
<p>Here is a recent copy of my <a href="uploads/1/2/4/5/124536544/CFMason_CV.pdf">CV</a>.</p>
</section>
<section id="my-professional-travels" class="level2">
<h2 class="anchored" data-anchor-id="my-professional-travels">My Professional Travels</h2>
<p>From January to June of 1998 I was in New Zealand, at the <a href="http://www.mngt.waikato.ac.nz/depts/econ/index.asp">University of Waikato</a>; I also spent five weeks at the Centre for Resource and Environmental Studies (which apparently has since been folded into the <a href="https://fennerschool.anu.edu.au">Fenner School of Environment and Society</a>, at the Australia National University. In the Fall of 2003, I was a Visiting Fellow at Cambridge University, in <a href="http://www.clarehall.cam.ac.uk/">Clare Hall</a>; I am now a life member of Clare Hall. I spent the Spring of 2004 at the University of California in Davis, where I taught in the <a href="http://are.ucdavis.edu/">Department of Agricultural and Resource Economics</a>.</p>
<p>During the Fall of 2008 I spent two months at the <a href="http://www.smithschool.ox.ac.uk/">Smith School of Enterprise and the Environment</a> at the University of Oxford, as a Visiting Research Fellow. I enjoyed the experience so much I went back during the summers of 2009 through 2011. During Fall 2012 I was a Visiting Scholar at the <a href="http://www.oxcarre.ox.ac.uk/">Oxford Centre for the Analysis of Resource Rich Economies</a>, part of the Department of Economics at the University of Oxford), where I am External Research Associate. I was a visiting scholar as part of the E3 program (Environmental and Energy Economics), as part of the University of California (Santa Barbara), in January and February of 2013; from March to May of 2013 I was a visiting scholar at the prestigious <a href="http://www.feem.it/">Fondazione Eni Enrico Mattei</a>, in Venice; and I spent June at the <a href="http://www2.toulouse.inra.fr/lerna/index.php?lang=eng">Toulouse School of Economics</a>. In December 2013 I was a visiting researcher at the <a href="https://www.cesifo-group.de/ifoHome.html">CESifo</a> group in Munich Germany. During 2014 and 2015 I was a Visiting Professor at the <a href="http://www.lse.ac.uk/GranthamInstitute/">Grantham Institute</a> (part of the London School of Economics) and with the <a href="http://www.sdu.dk/en/om_sdu/institutter_centre/i_miljo_og_erhvervsoekonomi">Environmental Economics</a> group at the University of Southern Denmark. In June 2016 I was a visiting scholar in the <a href="http://www.bath.ac.uk/economics/">Department of Economics</a> at the University of Bath.</p>
</section>
<section id="get-in-touch." class="level2">
<h2 class="anchored" data-anchor-id="get-in-touch.">Get In Touch.</h2>
<p><a href="mailto:bambuzlr@uwyo.edu">bambuzlr at uwyo dot edu</a></p>
<p><a href="mailto:bambuzlr@uwyo.edu" class="cta-button">CONTACT ME</a></p>
</section>
</div>
<style>
  body.page-index .navbar {
    display: none !important;
  }
</style>
<script>
window.addEventListener('DOMContentLoaded', () => {
  const heroNavbar = document.getElementById('hero-navbar');
  const defaultNavbar = document.querySelector('.navbar');

  if (heroNavbar) heroNavbar.style.transform = 'translateY(0)';
  if (defaultNavbar) defaultNavbar.style.display = 'none';
});

window.addEventListener('scroll', () => {
  const heroNavbar = document.getElementById('hero-navbar');
  const defaultNavbar = document.querySelector('.navbar');

  if (window.scrollY > 50) {
    if (heroNavbar) heroNavbar.style.transform = 'translateY(-100%)';  // fully hide
    if (defaultNavbar) defaultNavbar.style.display = 'flex';           // show Quarto nav
  } else {
    if (heroNavbar) heroNavbar.style.transform = 'translateY(0)';      // show hero nav
    if (defaultNavbar) defaultNavbar.style.display = 'none';           // hide Quarto nav
  }
});
</script>



</main> <!-- /main -->
<script type="text/javascript" src="links.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Powered with GitHub and Quarto<br>© Chuck Mason, 2025</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>